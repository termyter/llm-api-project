#!/usr/bin/env python3
"""
–î–µ–Ω—å 4: –°—Ä–∞–≤–Ω–µ–Ω–∏–µ —Ç–µ–º–ø–µ—Ä–∞—Ç—É—Ä—ã
–û–¥–∏–Ω –∏ —Ç–æ—Ç –∂–µ –∑–∞–ø—Ä–æ—Å —Å temperature = 0, 0.7, 1.2
–ê–Ω–∞–ª–∏–∑: —Ç–æ—á–Ω–æ—Å—Ç—å, –∫—Ä–µ–∞—Ç–∏–≤–Ω–æ—Å—Ç—å, —Ä–∞–∑–Ω–æ–æ–±—Ä–∞–∑–∏–µ
"""

import os
from dotenv import load_dotenv
from openai import OpenAI

load_dotenv()

client = OpenAI(
    api_key=os.getenv("OPENAI_API_KEY"),
    base_url="https://api.deepseek.com"
)

# –û–¥–∏–Ω –∏ —Ç–æ—Ç –∂–µ –∑–∞–ø—Ä–æ—Å –¥–ª—è –≤—Å–µ—Ö —Ç–µ–º–ø–µ—Ä–∞—Ç—É—Ä
TASK = "–ü—Ä–∏–¥—É–º–∞–π 5 –Ω–µ–æ–±—ã—á–Ω—ã—Ö –ø—Ä–∏–º–µ–Ω–µ–Ω–∏–π –æ–±—ã—á–Ω–æ–π –∫–∞–Ω—Ü–µ–ª—è—Ä—Å–∫–æ–π —Å–∫—Ä–µ–ø–∫–∏."

TEMPERATURES = [0, 0.7, 1.2]


def request_with_temperature(temp):
    """–û—Ç–ø—Ä–∞–≤–ª—è–µ—Ç –∑–∞–ø—Ä–æ—Å —Å —É–∫–∞–∑–∞–Ω–Ω–æ–π —Ç–µ–º–ø–µ—Ä–∞—Ç—É—Ä–æ–π."""
    response = client.chat.completions.create(
        model="deepseek-chat",
        messages=[
            {"role": "user", "content": TASK}
        ],
        temperature=temp
    )
    return response


def main():
    print("=" * 60)
    print("üå°Ô∏è  –î–ï–ù–¨ 4: –°–†–ê–í–ù–ï–ù–ò–ï –¢–ï–ú–ü–ï–†–ê–¢–£–†–´")
    print("=" * 60)
    print(f"\nüìù –ó–∞–ø—Ä–æ—Å: {TASK}")
    print(f"üå°Ô∏è  –¢–µ–º–ø–µ—Ä–∞—Ç—É—Ä—ã: {TEMPERATURES}")
    print("=" * 60)

    results = []

    for temp in TEMPERATURES:
        print(f"\n{'‚îÄ' * 60}")
        print(f"\nüìå –¢–ï–ú–ü–ï–†–ê–¢–£–†–ê: {temp}")
        if temp == 0:
            print("   (–¥–µ—Ç–µ—Ä–º–∏–Ω–∏—Ä–æ–≤–∞–Ω–Ω—ã–π, –º–∞–∫—Å–∏–º–∞–ª—å–Ω–æ –ø—Ä–µ–¥—Å–∫–∞–∑—É–µ–º—ã–π)")
        elif temp == 0.7:
            print("   (–±–∞–ª–∞–Ω—Å –º–µ–∂–¥—É —Ç–æ—á–Ω–æ—Å—Ç—å—é –∏ –∫—Ä–µ–∞—Ç–∏–≤–Ω–æ—Å—Ç—å—é)")
        elif temp == 1.2:
            print("   (–≤—ã—Å–æ–∫–∞—è –∫—Ä–µ–∞—Ç–∏–≤–Ω–æ—Å—Ç—å, –Ω–µ–ø—Ä–µ–¥—Å–∫–∞–∑—É–µ–º–æ—Å—Ç—å)")

        print(f"\nüì§ –û—Ç–ø—Ä–∞–≤–∏–ª–∏:")
        print(f"   user: {TASK}")
        print(f"   temperature: {temp}")

        response = request_with_temperature(temp)
        answer = response.choices[0].message.content
        tokens = response.usage.total_tokens

        print(f"\nüì• –û—Ç–≤–µ—Ç:")
        print(answer)
        print(f"\nüìä –¢–æ–∫–µ–Ω–æ–≤: {tokens}")

        results.append({
            "temp": temp,
            "answer": answer,
            "tokens": tokens
        })

    # --- –ü–æ–≤—Ç–æ—Ä–Ω—ã–π –∑–∞–ø—Ä–æ—Å –¥–ª—è –ø—Ä–æ–≤–µ—Ä–∫–∏ —Å—Ç–∞–±–∏–ª—å–Ω–æ—Å—Ç–∏ ---
    print("\n" + "=" * 60)
    print("üîÅ –ü–†–û–í–ï–†–ö–ê –°–¢–ê–ë–ò–õ–¨–ù–û–°–¢–ò: –ø–æ–≤—Ç–æ—Ä—è–µ–º –∫–∞–∂–¥—ã–π –∑–∞–ø—Ä–æ—Å –µ—â—ë —Ä–∞–∑")
    print("=" * 60)

    results_repeat = []

    for temp in TEMPERATURES:
        print(f"\n{'‚îÄ' * 60}")
        print(f"\nüìå –¢–ï–ú–ü–ï–†–ê–¢–£–†–ê: {temp} (–ø–æ–≤—Ç–æ—Ä)")

        response = request_with_temperature(temp)
        answer = response.choices[0].message.content
        tokens = response.usage.total_tokens

        print(f"\nüì• –û—Ç–≤–µ—Ç:")
        print(answer)
        print(f"\nüìä –¢–æ–∫–µ–Ω–æ–≤: {tokens}")

        results_repeat.append({
            "temp": temp,
            "answer": answer,
            "tokens": tokens
        })

    # --- –¢–∞–±–ª–∏—Ü–∞ —Å—Ä–∞–≤–Ω–µ–Ω–∏—è ---
    print("\n" + "=" * 60)
    print("üìà –°–†–ê–í–ù–ï–ù–ò–ï:")
    print(f"  –¢–µ–º–ø–µ—Ä–∞—Ç—É—Ä–∞ 0   ‚Äî —Ç–æ–∫–µ–Ω–æ–≤: {results[0]['tokens']} / –ø–æ–≤—Ç–æ—Ä: {results_repeat[0]['tokens']}")
    print(f"  –¢–µ–º–ø–µ—Ä–∞—Ç—É—Ä–∞ 0.7 ‚Äî —Ç–æ–∫–µ–Ω–æ–≤: {results[1]['tokens']} / –ø–æ–≤—Ç–æ—Ä: {results_repeat[1]['tokens']}")
    print(f"  –¢–µ–º–ø–µ—Ä–∞—Ç—É—Ä–∞ 1.2 ‚Äî —Ç–æ–∫–µ–Ω–æ–≤: {results[2]['tokens']} / –ø–æ–≤—Ç–æ—Ä: {results_repeat[2]['tokens']}")
    print("=" * 60)

    # --- –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–π –∞–Ω–∞–ª–∏–∑ —á–µ—Ä–µ–∑ LLM ---
    print("\n" + "=" * 60)
    print("ü§ñ –ê–í–¢–û–ú–ê–¢–ò–ß–ï–°–ö–ò–ô –ê–ù–ê–õ–ò–ó: LLM —Å—Ä–∞–≤–Ω–∏–≤–∞–µ—Ç –≤—Å–µ –æ—Ç–≤–µ—Ç—ã")
    print("=" * 60)

    analysis = client.chat.completions.create(
        model="deepseek-chat",
        messages=[
            {
                "role": "system",
                "content": (
                    "–¢—ã ‚Äî –∞–Ω–∞–ª–∏—Ç–∏–∫. –¢–µ–±–µ –¥–∞–ª–∏ 6 –æ—Ç–≤–µ—Ç–æ–≤ –Ω–∞ –æ–¥–∏–Ω –∏ —Ç–æ—Ç –∂–µ –∑–∞–ø—Ä–æ—Å "
                    "(–ø–æ 2 –æ—Ç–≤–µ—Ç–∞ –Ω–∞ –∫–∞–∂–¥—É—é –∏–∑ 3 —Ç–µ–º–ø–µ—Ä–∞—Ç—É—Ä: 0, 0.7, 1.2). "
                    "–ü—Ä–æ–∞–Ω–∞–ª–∏–∑–∏—Ä—É–π:\n"
                    "1. –¢–æ—á–Ω–æ—Å—Ç—å ‚Äî –Ω–∞—Å–∫–æ–ª—å–∫–æ –æ—Ç–≤–µ—Ç—ã –ø–æ –¥–µ–ª—É –∏ –∫–æ—Ä—Ä–µ–∫—Ç–Ω—ã?\n"
                    "2. –ö—Ä–µ–∞—Ç–∏–≤–Ω–æ—Å—Ç—å ‚Äî –Ω–∞—Å–∫–æ–ª—å–∫–æ –∏–¥–µ–∏ –æ—Ä–∏–≥–∏–Ω–∞–ª—å–Ω—ã –∏ –Ω–µ–æ–∂–∏–¥–∞–Ω–Ω—ã?\n"
                    "3. –†–∞–∑–Ω–æ–æ–±—Ä–∞–∑–∏–µ ‚Äî –Ω–∞—Å–∫–æ–ª—å–∫–æ –æ—Ç–ª–∏—á–∞—é—Ç—Å—è –¥–≤–∞ –æ—Ç–≤–µ—Ç–∞ –ø—Ä–∏ –æ–¥–Ω–æ–π —Ç–µ–º–ø–µ—Ä–∞—Ç—É—Ä–µ?\n"
                    "4. –°—Ç–∞–±–∏–ª—å–Ω–æ—Å—Ç—å ‚Äî –ø—Ä–∏ –∫–∞–∫–æ–π —Ç–µ–º–ø–µ—Ä–∞—Ç—É—Ä–µ –ø–æ–≤—Ç–æ—Ä–Ω—ã–µ –æ—Ç–≤–µ—Ç—ã –±–ª–∏–∂–µ –∫ –ø–µ—Ä–≤—ã–º?\n"
                    "5. –†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏ ‚Äî –∫–∞–∫–∞—è —Ç–µ–º–ø–µ—Ä–∞—Ç—É—Ä–∞ –ø–æ–¥—Ö–æ–¥–∏—Ç –¥–ª—è –∫–∞–∫–∏—Ö –∑–∞–¥–∞—á?\n\n"
                    "–ë—É–¥—å –∫—Ä–∞—Ç–∫–∏–º –∏ –∫–æ–Ω–∫—Ä–µ—Ç–Ω—ã–º. –î–∞–π –∏—Ç–æ–≥–æ–≤—ã–π —Ä–µ–π—Ç–∏–Ω–≥."
                )
            },
            {
                "role": "user",
                "content": (
                    f"–ó–∞–ø—Ä–æ—Å: {TASK}\n\n"
                    f"--- –¢–ï–ú–ü–ï–†–ê–¢–£–†–ê 0 (–∑–∞–ø—Ä–æ—Å 1) ---\n{results[0]['answer']}\n\n"
                    f"--- –¢–ï–ú–ü–ï–†–ê–¢–£–†–ê 0 (–∑–∞–ø—Ä–æ—Å 2) ---\n{results_repeat[0]['answer']}\n\n"
                    f"--- –¢–ï–ú–ü–ï–†–ê–¢–£–†–ê 0.7 (–∑–∞–ø—Ä–æ—Å 1) ---\n{results[1]['answer']}\n\n"
                    f"--- –¢–ï–ú–ü–ï–†–ê–¢–£–†–ê 0.7 (–∑–∞–ø—Ä–æ—Å 2) ---\n{results_repeat[1]['answer']}\n\n"
                    f"--- –¢–ï–ú–ü–ï–†–ê–¢–£–†–ê 1.2 (–∑–∞–ø—Ä–æ—Å 1) ---\n{results[2]['answer']}\n\n"
                    f"--- –¢–ï–ú–ü–ï–†–ê–¢–£–†–ê 1.2 (–∑–∞–ø—Ä–æ—Å 2) ---\n{results_repeat[2]['answer']}"
                )
            }
        ]
    )

    print(analysis.choices[0].message.content)
    print(f"\nüìä –¢–æ–∫–µ–Ω–æ–≤ –Ω–∞ –∞–Ω–∞–ª–∏–∑: {analysis.usage.total_tokens}")
    print("=" * 60)


if __name__ == "__main__":
    main()
